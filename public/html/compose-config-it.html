<html>
<head>
    <title>Configurare Translator</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="../styles/teams.css">

    <style>
        @charset "UTF-8";

        body {
            padding: .8rem 3.2rem;
        }

        .language-lists-container {
            display: flex;
            width: 100%;
            align-items: stretch;
            margin-top: 1.2rem;
        }

        .language-list-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .language-list {
            flex: 1;
        }

        .language-list li {
            cursor: pointer;
            padding-bottom: .6rem;
        }
    </style>
</head>
<body>
    <h4 class="ts-modal-dialog-title">Configurare Translator</h4>

    <p>Selezionare le lingue da tradurre, e il loro ordine, trascinandole nell'elenco «Lingue selezionate».</p>

    <button onclick="submit()" class="ts-btn ts-btn-primary">Fatto</button>
    
    <div class="language-lists-container">
        <div class="language-list-container">
            <div class="section-caption">Lingue selezionate</div>
            <ul id="selected" class="language-list">
        </div>

        <div class="language-list-container">
            <div class="section-caption">Lingue disponibili</div>
            <ul id="available" class="language-list">
                <li data-id="af">afrikaans</li>
                <li data-id="ar">arabo</li>
                <li data-id="bn">bengalese</li>
                <li data-id="bs-Latn">bosniaco</li>
                <li data-id="bg">bulgaro</li>
                <li data-id="ca">catalano</li>
                <li data-id="zh-CHS">cinese semplificato</li>
                <li data-id="zh-CHT">cinese tradizionale</li>
                <li data-id="hr">croata</li>
                <li data-id="cs">ceco</li>
                <li data-id="da">danese</li>
                <li data-id="nl">olandese</li>
                <li data-id="en">inglese</li>
                <li data-id="et">estone</li>
                <li data-id="fj">fijiano</li>
                <li data-id="fil">filippino</li>
                <li data-id="fi">finlandese</li>
                <li data-id="fr">francese</li>
                <li data-id="de">tedesco</li>
                <li data-id="el">greco</li>
                <li data-id="ht">haitiano</li>
                <li data-id="he">ebreo</li>
                <li data-id="hi">hindi</li>
                <li data-id="hu">ungarese</li>
                <li data-id="id">indonesiano</li>
                <li data-id="it">italiano</li>
                <li data-id="ja">giapponese</li>
                <li data-id="tlh">klingon</li>
                <li data-id="ko">coreano</li>
                <li data-id="lv">latviano</li>
                <li data-id="lt">lituano</li>
                <li data-id="mg">malgascio</li>
                <li data-id="ms">malese</li>
                <li data-id="mt">maltese</li>
                <li data-id="no">norvegese</li>
                <li data-id="fa">persiano</li>
                <li data-id="pl">polacco</li>
                <li data-id="pt">portoghese</li>
                <li data-id="ro">rumeno</li>
                <li data-id="ru">russo</li>
                <li data-id="sm">samoano</li>
                <li data-id="sr-Cyrl">serbo (cirillico)</li>
                <li data-id="sr-Latn">serbo (latino)</li>
                <li data-id="sk">slovaco</li>
                <li data-id="sl">sloveno</li>
                <li data-id="es">spagnolo</li>
                <li data-id="sv">svedese</li>
                <li data-id="ty">tahitiano</li>
                <li data-id="th">tailandese</li>
                <li data-id="to">tonga</li>
                <li data-id="tr">turco</li>
                <li data-id="uk">ucraino</li>
                <li data-id="ur">urdu</li>
                <li data-id="vi">vietnamese</li>
                <li data-id="cy">gallese</li>
            </ul>
        </div>
    </div>
    </ul>

    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.1.1.min.js"></script>
    <script src="https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.6.0/Sortable.min.js"></script>
    <script type="text/javascript">
          microsoftTeams.initialize();

          // Parse query parameters
          let queryParams = {};
          location.search.substr(1).split("&").forEach(function(item) {
              let s = item.split("="),
              k = s[0],
              v = s[1] && decodeURIComponent(s[1]);
              queryParams[k] = v;
          });

          let availableSortable = Sortable.create(available, {
            group: {
                name: 'languages',
            },
            sort: false,
            animation: 100,
            onAdd: (evt) => {
                availableSortable.sort(initialSort);
            }
          });
          let initialSort = availableSortable.toArray();

          Sortable.create(selected, {
            group: {
                name: 'languages',
            },
            animation: 100
          });

          // Initialize state of checkboxes
          $().ready(() => {
            let selected = $("#selected");

            let languages = queryParams["languages"] || "";
            languages.split(",").forEach((lang) => {
                selected.append($("#available > li[data-id='" + lang + "']"));
            });
          });

          function submit() {
            let selectedLanguages = $("#selected li").get();
            let newSetting = selectedLanguages.map(c => c.attributes["data-id"].value).join(",");
            microsoftTeams.authentication.notifySuccess(newSetting);
          }

          function sortAvailableLanguages() {
            let list = $("#available");
            list.find("li").detach().sort(function(a, b) {
                return a.innerHTML.localeCompare(b.innerHTML);
            }).each(function(index, el) {
                list.append(el);
            });
        }
    </script>
</body>
</html>